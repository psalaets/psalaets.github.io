<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="What parts to test in a Vuex module"><link rel="stylesheet" href="/styles/1.40.0/index.css"><link rel="canonical" href="https://paulsalaets.com/"><link rel="alternate" type="application/rss+xml" title="Subscribe to posts" href="/feed.xml"><title>What to test in Vuex modules | paulsalaets.com</title></head><body class="text-base font-sans text-gray-900"><header class="p-4 mx-auto sm:max-w-3xl sm:px-20"><a href="#main" class="skipnav">skip to main content</a><nav><div class="w-full text-center mb-2 md:mb-0 md:inline-block md:w-auto md:text-left"><a class="font-bold inline-block mr-3" href="/" title="Home">Paul Salaets</a></div><div class="w-full text-center md:inline-block md:w-auto md:text-left"><a class="px-3 py-2" href="/" title="Home"><span class="inline-block border-b-4 border-white">Home</span> </a><a class="px-3 py-2" href="/about/" title="About"><span class="inline-block border-b-4 border-white">About</span> </a><a class="px-3 py-2" href="/archive/" title="Archive"><span class="inline-block border-b-4 border-white">Archive</span></a></div></nav></header><main id="main" class="pb-4"><div class="mx-auto bg-white p-4 sm:max-w-3xl sm:px-20"><article><header class="mb-8"><h1 class="text-3xl font-bold">What to test in Vuex modules</h1><span class="text-sm">8 Sep 2019</span></header><section class="post-content"><p>Testing is good and we like it. However, testing every single thing can take too long and become tedious. While inching towards 100% test coverage you may find that some tests have a very low value-to-cost ratio.</p><p>Sometimes you can't test everything even if you wanted to.</p><p>When it comes to testing our Vuex modules, my team has decided that some tests can be skipped.</p><h2>Getters</h2><p><strong>No tests needed when:</strong></p><p>The getter is just returning something from the <code>state</code>.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// no tests needed</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">modalVisible</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">return</span> state<span class="token punctuation">.</span>modal<span class="token punctuation">.</span>visible<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p><strong>Write tests when:</strong></p><p>The getter does a transformation or filtering.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// write tests for this</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">filteredRecords</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">const</span> name <span class="token operator">=</span> state<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>name<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token keyword">return</span> state<span class="token punctuation">.</span>records</span><br><span class="highlight-line">      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">record</span> <span class="token operator">=></span> record<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p><strong>Write tests when:</strong></p><p>The getter takes arguments.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// write tests for this</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">recordsById</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">return</span> <span class="token parameter">id</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">      <span class="token keyword">return</span> state<span class="token punctuation">.</span>records<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">record</span> <span class="token operator">=></span> record<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><h2>Mutations</h2><p><strong>No tests needed when:</strong></p><p>The mutation is just getting something from its payload and setting it on <code>state</code>.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// no tests needed</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token constant">LOAD_DOMAINS_COMPLETED</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> payload</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    state<span class="token punctuation">.</span>domains <span class="token operator">=</span> payload<span class="token punctuation">.</span>domains<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p><strong>No tests needed when:</strong></p><p>The mutation is hardcoded.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// no tests needed</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token constant">SHOW_MODAL</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    state<span class="token punctuation">.</span>modal<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><h2>Actions</h2><p><strong>No tests needed when:</strong></p><p>The action only commits an analogous mutation.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// no tests needed</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">showModal</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'SHOW_MODAL'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p><strong>Write tests when:</strong></p><p>The action orchestrates other actions or mutations.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// write tests for this</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">load</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'LOADING_STARTED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">    <span class="token keyword">return</span> context<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'loadRecords'</span><span class="token punctuation">)</span></span><br><span class="highlight-line">      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">records</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>records<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">          <span class="token keyword">return</span> context<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'loadSchedules'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">        <span class="token punctuation">}</span></span><br><span class="highlight-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span><br><span class="highlight-line">      <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'LOADING_ENDED'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p><strong>Write tests when:</strong></p><p>The action has conditional logic based on payload or getters.</p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token comment">// write tests for this</span></span><br><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>exists<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">      <span class="token keyword">return</span> context<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'update'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">      <span class="token keyword">return</span> context<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'create'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token punctuation">}</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><h3>Shameless plug</h3><p>I've written a <a href="https://github.com/psalaets/vuex-mock-context" rel="noopener">module</a> that makes it a little easier to test Vuex actions.</p><h2>When in doubt</h2><p>My favorite things to test are</p><ul><li>The most important things</li><li>The most complicated things</li><li>The things that always break</li></ul><p>Use your best judgement or start a conversation to determine if something needs a test.</p></section></article></div></main><footer class="p-8 text-center text-sm border-t-2 border-gray-200"><span>Â©2020 Paul Salaets</span><br><span>Built with <a href="https://www.11ty.io/" rel="noopener" class="text-blue-700 underline">Eleventy</a> and <a href="https://tailwindcss.com/" rel="noopener" class="text-blue-700 underline">Tailwind CSS</a></span></footer></body></html>