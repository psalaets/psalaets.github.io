<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="Angular components without breaking child selectors"><link rel="stylesheet" href="/1.5.0/main.css"><link rel="canonical" href="https://paulsalaets.com/"><title>Preserving child selectors in Angular | paulsalaets.com</title></head><body class="font-base font-sans text-gray-900"><header class="p-4 sm:p-8"><a href="#main" class="skipnav">skip to main content</a><nav><a class="font-bold text-sm sm:text-base inline-block mr-4" href="/" title="Home">Paul Salaets </a><a class="text-sm sm:text-base inline-block mr-4" href="/" title="Home">Home </a><a class="text-sm sm:text-base inline-block mr-4" href="/about" title="About">About </a><a class="text-sm sm:text-base inline-block mr-4" href="/archive" title="Archive">Archive</a></nav></header><main id="main" class="pb-4"><div class="mx-auto bg-white p-4 sm:max-w-3xl sm:px-16"><article><header class="mb-8"><h1 class="text-3xl font-bold">Preserving child selectors in Angular</h1><span class="text-sm">21 Apr 2017</span></header><section class="post-content"><p>Angular components leave custom elements in the dom and that breaks styles which rely on child selectors. Here's a workaround.</p><h3>Versions used below</h3><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string">"@angular/core"</span><span class="token punctuation">:</span> <span class="token string">"4.0.3"</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><h2>Scenario</h2><p>You've got some Angular components that look like</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token comment">/* parent */</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  selector<span class="token punctuation">:</span> <span class="token string">'my-list'</span><span class="token punctuation">,</span></span><br>  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`<br><span class="highlight-line">    &lt;ul></span><br><span class="highlight-line">      &lt;my-list-item>&lt;/my-list-item></span><br><span class="highlight-line">    &lt;/ul></span><br>  `</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ListComponent</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span></code></pre><p>and</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token comment">/* child */</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  selector<span class="token punctuation">:</span> <span class="token string">'my-list-item'</span><span class="token punctuation">,</span></span><br>  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`<br><span class="highlight-line">    &lt;li></span><br><span class="highlight-line">      &lt;span>1&lt;/span></span><br><span class="highlight-line">    &lt;/li></span><br>  `</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ListItemComponent</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span></code></pre><p>Since Angular components leave their custom elements in the dom, you get this dom nesting</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-list</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-list-item</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-list-item</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-list</span><span class="token punctuation">></span></span></span></code></pre><h2>Problem</h2><p>The nesting seen above breaks styles that use <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Child_selectors">child selectors</a>:</p><pre class="language-css"><code class="language-css"><span class="highlight-line"><span class="token comment">/* selector no longer matches */</span></span><br><span class="highlight-line"><span class="token selector">ul > li</span> <span class="token punctuation">{</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><h2>Workaround</h2><p>Change the child component's selector to something else, like an <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors">attribute selector</a>.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// changed to attribute selector</span></span><br><span class="highlight-line">  selector<span class="token punctuation">:</span> <span class="token string">'[my-list-item]'</span><span class="token punctuation">,</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token comment">// or even</span></span><br><span class="highlight-line">  <span class="token comment">// selector: 'li[my-list-item]',</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token comment">// outer li is removed because it'll be in parent template now</span></span><br>  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`<br><span class="highlight-line">    &lt;span>1&lt;/span></span><br>  `</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></code></pre><p>Parent template changes to</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">my-list-item</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></span></code></pre><p>the dom becomes</p><pre class="language-html"><code class="language-html"><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-list</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">my-list-item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><br><span class="highlight-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span><br><span class="highlight-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></span><br><span class="highlight-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-list</span><span class="token punctuation">></span></span></span></code></pre><p>and now the child selector matches. Sweet.</p><h2>What about binding things on child's root element?</h2><p>We lost the ability to bind things on the <code>&lt;li&gt;</code> because that moved out of the child template.</p><p><code>@HostBinding()</code> and <code>@HostListener()</code> can let us achieve that.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> HostBinding<span class="token punctuation">,</span> HostListener <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  selector<span class="token punctuation">:</span> <span class="token string">'[my-list-item]'</span><span class="token punctuation">,</span></span><br>  template<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`<br><span class="highlight-line">    &lt;span>1&lt;/span></span><br>  `</span></span><span class="token punctuation">,</span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ListItemComponent</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// Equivalent to &lt;li [class.active]="hasActiveClass"></span></span><br><span class="highlight-line">  @<span class="token function">HostBinding</span><span class="token punctuation">(</span><span class="token string">'class.active'</span><span class="token punctuation">)</span> hasActiveClass<span class="token punctuation">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token comment">// Equivalent to &lt;li (click)="handleClick()"></span></span><br><span class="highlight-line">  @<span class="token function">HostListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>hasActiveClass <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasActiveClass<span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Well, that wasn't ideal but it worked.</p></section></article></div></main><footer class="p-8 text-center text-sm border-t-2 border-gray-200"><span>©2019 Paul Salaets</span><br><span>Built with <a href="https://www.11ty.io/" rel="noopener noreferrer" class="text-blue-700 underline">Eleventy</a> and <a href="https://tailwindcss.com/" rel="noopener noreferrer" class="text-blue-700 underline">Tailwind CSS</a></span></footer></body></html>