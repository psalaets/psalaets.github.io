<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="description" content="How to use planes in the p2 JavasScript physics engine."><link rel="stylesheet" href="/1.3.0/main.css"><link rel="canonical" href="https://paulsalaets.com/"><title>Planes in p2.js | paulsalaets.com</title></head><body class="font-base font-sans text-gray-900"><header class="p-4 sm:p-8"><a href="#main" class="skipnav">skip to main content</a><nav><a class="font-bold text-sm sm:text-base inline-block mr-4" href="/" title="Home">Paul Salaets </a><a class="text-sm sm:text-base inline-block mr-4" href="/" title="Home">Home </a><a class="text-sm sm:text-base inline-block mr-4" href="/about" title="About">About </a><a class="text-sm sm:text-base inline-block mr-4" href="/archive" title="Archive">Archive</a></nav></header><main id="main" class="pb-4"><div class="mx-auto bg-white p-4 sm:max-w-3xl sm:px-16"><article><header class="mb-8"><h1 class="text-3xl font-bold">Planes in p2.js</h1><span class="text-sm">14 Jun 2015</span></header><section class="post-content"><p>It's not obvious what a plane is in a 2D physics engine.</p><h3>Versions used below</h3><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token string">"p2"</span><span class="token punctuation">:</span> <span class="token string">"0.6.1"</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Circles, rectangles and lines make sense in 2D but a plane feels more relevant in 3D worlds. Sure, a 2D world exists on one plane but that's not what a plane is in p2.</p><h2>Thinking about planes in p2</h2><p>A plane is a shape that extends infinitely in three directions (e.g. left, down, right). There is a flat edge on the other, non-infinite side.</p><h2>Planes as edges of the world</h2><p>Planes have one flat edge and nothing can get around or behind them. This makes planes a good candidate for edges of the game world.</p><h3>Floor</h3><p>The default plane orientation acts as a floor. It stretches down, left and right forever.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> floor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">floor<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h3>Ceiling</h3><p>Flipping it by 180 degrees makes a ceiling.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> ceiling <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// radians</span></span><br><span class="highlight-line">  angle<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">ceiling<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h3>Right wall</h3><p>Increasing a body's angle rotates it in the counterclockwise direction.</p><p>Right wall is rotated 90 degrees from the floor.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  angle<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">right<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h3>Left wall</h3><p>Left wall is rotated 270 degrees from the floor.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  angle<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">left<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h3>Angled</h3><p>You can use any angle to get slopes.</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> ramp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// ramp from bottom/left to top/right</span></span><br><span class="highlight-line">  angle<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">4</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">ramp<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h3>Prefer planes over lines and rectangles</h3><p>Lines and rectangles could be used for edges of the world but planes have a few advantages.</p><ol><li><p>You don't have to worry about planes being wide or tall enough. Nothing can get around or behind a plane.</p></li><li><p>Planes <a href="https://github.com/schteppe/p2.js#supported-collision-pairs">collide with more shapes</a> than Lines and Rectangles do.</p></li></ol><h2>Positioning planes</h2><p>Position of a plane is a little weird to think about. I've found that a plane's edge will intersect its position coordinate.</p><p>p2 is &quot;y up&quot;, y values increase as you go up. To put a floor 10 units above the origin I would use</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> floor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token comment">// the x value is irrelevant here, the plane spans the entire x axis</span></span><br><span class="highlight-line">  position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">floor<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>To put a left wall 100 units to the right of the origin</p><pre class="language-javascript"><code class="language-javascript"><span class="highlight-line"><span class="token keyword">var</span> leftWall <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  angle<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  <span class="token comment">// now the y value is irrelevant</span></span><br><span class="highlight-line">  position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">leftWall<span class="token punctuation">.</span><span class="token function">addShape</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">p2<span class="token punctuation">.</span>Plane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></section></article></div></main><footer class="p-8 text-center text-sm border-t-2 border-gray-200"><span>©2019 Paul Salaets</span><br><span>Built with <a href="https://www.11ty.io/" rel="noopener noreferrer" class="text-blue-700 underline">Eleventy</a> and <a href="https://tailwindcss.com/" rel="noopener noreferrer" class="text-blue-700 underline">Tailwind CSS</a></span></footer></body></html>